<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Evaluaci√≥n para Venta de Equipos M√©dicos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #0033a0;
      margin: 30px;
    }

    header {
      background-color: #003787;
      padding: 10px 0;
      text-align: center;
      border-radius: 10px;
      max-width: 100%;
      margin: 0 auto 30px auto;
    }

    header img {
      height: 140px;
      vertical-align: middle;
    }

    h1 {
      color: white;
      text-align: center;
      margin-bottom: 40px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      font-family: 'Times New Roman', serif;
    }

    .formulario {
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      max-width: 600px;
      margin: 0 auto;
      font-size: 20px;
    }

    label, select {
      display: block;
      margin: 10px 0 5px;
      font-size: 20px;
    }

    select, input[type="text"] {
      width: 100%;
      padding: 8px;
      font-size: 20px;
    }

    option {
      font-size: 20px;
    }

    button {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #0033a0;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .resultado {
      margin-top: 20px;
      font-weight: bold;
      color: red;
    }

    .advertencia {
      background-color: #fff3cd;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ffeeba;
      margin-bottom: 20px;
      font-size: 18px;
    }
  </style>
</head>
<body>

  <header>
    <img src="TecSalud.png" alt="Logo TecSalud" />
    <h1>Evaluaci√≥n para Venta de Equipos M√©dicos fuera de servicio o para baja</h1>
  </header>

  <div class="formulario">
    <div class="advertencia">
      <strong>‚ùó Advertencia:</strong> El equipo debe haberse dado de baja antes de contestar este formulario.
    </div>

    <label>¬øEl equipo m√©dico ya fue dado de baja?</label>
    <select id="BajaDeEquipo">
      <option value="5">S√≠</option>
      <option value="0">No</option>
    </select>

    <label>¬øPosterior a un an√°lisis t√©cnico, el equipo m√©dico es funcional?</label>
    <select id="funcional">
      <option value="0">Selecciona una opci√≥n</option>
      <option value="5">S√≠</option>
      <option value="1">Parcialmente</option>
      <option value="0">No</option>
    </select>

    <label>¬øEl equipo ya cumpli√≥ su tiempo de vida √∫til?</label>
    <select id="VidaUtil">
      <option value="0">Selecciona una opci√≥n</option>
      <option value="2">Sigue dentro del ciclo de vida √∫til</option>
      <option value="1">Mayor a 5 a√±os</option>
      <option value="1">No lo s√©</option>
      <option value="0">Super√≥ su ciclo de vida</option>
    </select>   

    <label>¬øEs posible repararlo?</label>
    <select id="costo">
      <option value="0">Selecciona una opci√≥n</option>
      <option value="2">S√≠, el costo de reparaci√≥n es menor al 50% del valor en el mercado</option>  
      <option value="1">S√≠, el costo supera el 50% del valor en el mercado</option>
      <option value="0">No</option>
    </select>

    <label>¬øExisten refacciones y consumibles disponibles?</label>
    <select id="refacciones">
      <option value="0">Selecciona una opci√≥n</option>
      <option value="5">S√≠</option>
      <option value="2">Dif√≠cil de conseguir</option>
      <option value="0">No</option>
    </select>

    <label>¬øHay demanda de este equipo en el mercado secundario?</label>
    <select id="demanda">
      <option value="0">Selecciona una opci√≥n</option>
      <option value="5">Alta</option>
      <option value="3">Media</option>
      <option value="1">Baja</option>
      <option value="0">Nula</option>
    </select>

    <label>¬øEl equipo es cr√≠tico?</label>
    <select id="critico">
      <option value="0">Selecciona una opci√≥n</option>
      <option value="3">S√≠</option>
      <option value="0">No</option>
    </select>

    
    <label>¬øEl equipo m√©dico cuenta con documentos contables o de propiedad?</label>
    <select id="documentos">
      <option value="0">Selecciona una opci√≥n</option>
      <option value="5">S√≠</option>
      <option value="-5">No</option>
    </select>

    <label>Nombre del equipo:</label>
    <input type="text" id="nombreEquipo" required>

    <label>Marca:</label>
    <input type="text" id="marca" required>

    <label>Modelo:</label>
    <input type="text" id="modelo" required>

    <label>Foto del equipo:</label>
    <input type="file" id="foto" accept="image/*">

    <button onclick="guardarYRedirigir()">Evaluar</button>
    <div class="resultado" id="resultado"></div>
  </div>

<script>
  const camposEvaluacion = [
    "funcional", "VidaUtil", "costo", "refacciones", "demanda", "documentos", "critico"
  ];

  const funcionEvaluar = ["VidaUtil", "costo"];

  document.getElementById("BajaDeEquipo").addEventListener("change", function () {
    const desactivar = this.value === "0";
    camposEvaluacion.forEach(id => {
      document.getElementById(id).disabled = desactivar;
    });
  });

  document.getElementById("funcional").addEventListener("change", function () {
    const desactivar = this.value === "5";
    funcionEvaluar.forEach(id => {
      document.getElementById(id).disabled = desactivar;
    });
  });

  document.getElementById("VidaUtil").addEventListener("change", function () {
    const desactivar = this.value === "0";
    document.getElementById("costo").disabled = desactivar;
  });

  function guardarYRedirigir() {
    if (document.getElementById("BajaDeEquipo").value === "0") {
      document.getElementById("resultado").innerHTML =
        "‚ö†Ô∏è <strong>Debe confirmar que el equipo fue dado de baja para continuar con la evaluaci√≥n.</strong>";
      return;
    }

    const camposRequeridos = [
      "nombreEquipo", "marca", "modelo", "funcional",
      "VidaUtil", "costo", "refacciones", "demanda", "documentos", "critico"
    ];

    for (let campo of camposRequeridos) {
      const valor = document.getElementById(campo).value;
      if (!valor || valor === "0") {
        document.getElementById("resultado").innerHTML =
          "‚ö†Ô∏è <strong>Todos los campos deben ser completados antes de continuar.</strong>";
        return;
      }
    }

    const fileInput = document.getElementById("foto");
    const archivo = fileInput.files[0];

    const respuestas = {
      nombreEquipo: document.getElementById("nombreEquipo").value,
      marca: document.getElementById("marca").value,
      modelo: document.getElementById("modelo").value,
      baja: document.getElementById("BajaDeEquipo").value,
      funcional: document.getElementById("funcional").value,
      vida: document.getElementById("VidaUtil").value,
      costo: document.getElementById("costo").value,
      refacciones: document.getElementById("refacciones").value,
      demanda: document.getElementById("demanda").value,
      documentos: document.getElementById("documentos").value,
      critico: document.getElementById("critico").value
    };

    // üö® Validaci√≥n cr√≠tica: Si es cr√≠tico y no tiene documentos
    if (respuestas.critico === "3" && respuestas.documentos === "-5") {
      respuestas.uso = "solo refacciones";
      localStorage.setItem("respuestasEvaluacion", JSON.stringify(respuestas));
      document.getElementById("resultado").innerHTML =
        "‚ö†Ô∏è <strong>Este equipo es cr√≠tico y no cuenta con documentos. No puede ser vendido. Solo debe usarse para refacciones.</strong>";
      return;
    }

    // Si no es cr√≠tico sin documentos, continuar flujo normal
    if (archivo) {
      const reader = new FileReader();
      reader.onload = function (e) {
        respuestas.foto = e.target.result;
        localStorage.setItem("respuestasEvaluacion", JSON.stringify(respuestas));
        window.location.href = "Results.html";
      };
      reader.readAsDataURL(archivo);
    } else {
      localStorage.setItem("respuestasEvaluacion", JSON.stringify(respuestas));
      window.location.href = "Results.html";
    }
  }
</script>


</body>
</html>

